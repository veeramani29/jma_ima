!function(){var e={},t=function(t){for(var n=e[t],a=n.deps,r=n.defn,o=a.length,l=new Array(o),s=0;s<o;++s)l[s]=i(a[s]);var c=r.apply(null,l);if(void 0===c)throw"module ["+t+"] returned undefined";n.instance=c},n=function(t,n,i){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===i)throw"no definition function for "+t;e[t]={deps:n,defn:i,instance:void 0}},i=function(n){var i=e[n];if(void 0===i)throw"module ["+n+"] was undefined";return void 0===i.instance&&t(n),i.instance};({}).bolt={module:{api:{define:n,require:function(e,t){for(var n=e.length,a=new Array(n),r=0;r<n;++r)a.push(i(e[r]));t.apply(null,t)},demand:i}}};var a=n,r=function(e,t){a(e,[],function(){return t})};r("4",tinymce.util.Tools.resolve),a("1",["4"],function(e){return e("tinymce.PluginManager")}),a("2",["4"],function(e){return e("tinymce.util.Tools")}),a("5",["4"],function(e){return e("tinymce.Env")}),a("6",["4"],function(e){return e("tinymce.util.JSON")}),a("7",["4"],function(e){return e("tinymce.util.XHR")}),a("8",["4"],function(e){return e("tinymce.ui.Throbber")}),a("e",["4"],function(e){return e("tinymce.util.Promise")}),r("d",document),a("9",["e","2","d"],function(e,t,n){return function(n){function i(e,t){return e?e.replace(/\/$/,"")+"/"+t.replace(/^\//,""):t}function a(e,t,a,r){var o,l;(o=new XMLHttpRequest).open("POST",n.url),o.withCredentials=n.credentials,o.upload.onprogress=function(e){r(e.loaded/e.total*100)},o.onerror=function(){a("Image upload failed due to a XHR Transport error. Code: "+o.status)},o.onload=function(){var e;return o.status<200||o.status>=300?void a("HTTP Error: "+o.status):(e=JSON.parse(o.responseText),e&&"string"==typeof e.location?void t(i(n.basePath,e.location)):void a("Invalid JSON: "+o.responseText))},(l=new FormData).append("file",e.blob(),e.filename()),o.send(l)}function r(t,n){return new e(function(e,i){try{n(t,e,i,l)}catch(e){i(e.message)}})}function o(e){return e===a}var l=function(){};return n=t.extend({credentials:!1,handler:a},n),{upload:function(t){return!n.url&&o(n.handler)?e.reject("Upload url missng from the settings."):r(t,n.handler)}}}}),r("b",Math),a("a",["2","b","d"],function(e,t,n){return{getImageSize:function(e,i){function a(e,t){r.parentNode&&r.parentNode.removeChild(r),i({width:e,height:t})}var r=n.createElement("img");r.onload=function(){a(t.max(r.width,r.clientWidth),t.max(r.height,r.clientHeight))},r.onerror=function(){a()};var o=r.style;o.visibility="hidden",o.position="fixed",o.bottom=o.left=0,o.width=o.height="auto",n.body.appendChild(r),r.src=e;var l=document.querySelector("div[aria-selected='true']").id,s=(document.querySelector("div[aria-selected='true']").className,l.split("-"));if("mce-tab mce-active"==document.getElementById(l).className){var c=s[0]+"-t2";document.getElementById(c).click()}},buildListItems:function(t,n,i){function a(t,i){return i=i||[],e.each(t,function(e){var t={text:e.text||e.title};e.menu?t.menu=a(e.menu):(t.value=e.value,n(t)),i.push(t)}),i}return a(t,i||[])},removePixelSuffix:function(e){return e&&(e=e.replace(/px$/,"")),e},addPixelSuffix:function(e){return e.length>0&&/^[0-9]+$/.test(e)&&(e+="px"),e},mergeMargins:function(e){if(e.margin){var t=e.margin.split(" ");switch(t.length){case 1:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[0],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[0];break;case 2:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[0],e["margin-left"]=e["margin-left"]||t[1];break;case 3:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[1];break;case 4:e["margin-top"]=e["margin-top"]||t[0],e["margin-right"]=e["margin-right"]||t[1],e["margin-bottom"]=e["margin-bottom"]||t[2],e["margin-left"]=e["margin-left"]||t[3]}delete e.margin}return e}}}),r("c",RegExp),a("3",["5","6","2","7","8","9","a","b","c","d"],function(e,t,n,i,a,r,o,l,s,c){return function(c){function u(e){var n=c.settings.image_list;"string"==typeof n?i.send({url:n,success:function(n){e(t.parse(n))}}):"function"==typeof n?n(e):e(n)}function d(t){function i(){var e=new a(p.getEl()),t=this.value(),n=new r({url:N.images_upload_url,basePath:N.images_upload_base_path,credentials:N.images_upload_credentials,handler:N.images_upload_handler}),i=c.editorUpload.blobCache.create({blob:t,name:t.name?t.name.replace(/\.[^\.]+$/,""):null,base64:"data:image/fake;base64,="}),o=function(){e.hide(),URL.revokeObjectURL(i.blobUri())};return e.show(),n.upload(i).then(function(e){var t=p.find("#src");return t.value(e),p.find("tabpanel")[0].activateTab(0),t.fire("change"),o(),e},function(e){c.windowManager.alert(e),o()})}function u(e){return c.schema.getTextBlockElements()[e.nodeName]}function d(){var e,t,n,i;e=p.find("#width")[0],t=p.find("#height")[0],e&&t&&(n=e.value(),i=t.value(),p.find("#constrain")[0].checked()&&v&&y&&n&&i&&(v!=n?(i=l.round(n/v*i),isNaN(i)||t.value(i)):(n=l.round(i/y*n),isNaN(n)||e.value(n))),v=n,y=i)}function g(){if(c.settings.image_advtab){var e=p.toJSON(),t=_.parseStyle(e.style);t=o.mergeMargins(t),e.vspace&&(t["margin-top"]=t["margin-bottom"]=o.addPixelSuffix(e.vspace)),e.hspace&&(t["margin-left"]=t["margin-right"]=o.addPixelSuffix(e.hspace)),e.border&&(t["border-width"]=o.addPixelSuffix(e.border)),p.find("#style").value(_.serializeStyle(_.parseStyle(_.serializeStyle(t))))}}function m(e){function t(){e.onload=e.onerror=null,c.selection&&(c.selection.select(e),c.nodeChanged())}e.onload=function(){S.width||S.height||!I||_.setAttribs(e,{width:e.clientWidth,height:e.clientHeight}),t()},e.onerror=t}function f(){var e,t;g(),d(),(S=n.extend(S,p.toJSON())).alt||(S.alt=""),S.title||(S.title=""),""===S.width&&(S.width=null),""===S.height&&(S.height=null),S.style||(S.style=null),S={src:S.src,alt:S.alt,title:S.title,width:S.width,height:S.height,style:S.style,caption:S.caption,class:S.class},c.undoManager.transact(function(){if(S.src){if(""===S.title&&(S.title=null),h?_.setAttribs(h,S):(S.id="__mcenew",c.focus(),c.selection.setContent(_.createHTML("img",S)),h=_.get("__mcenew"),_.setAttrib(h,"id",null)),c.editorUpload.uploadImagesAuto(),!1===S.caption&&_.is(h.parentNode,"figure.image")&&(e=h.parentNode,_.insertAfter(h,e),_.remove(e)),!0!==S.caption)m(h);else if(!_.is(h.parentNode,"figure.image")){t=h,h=h.cloneNode(!0),(e=_.create("figure",{class:"image"})).appendChild(h),e.appendChild(_.create("figcaption",{contentEditable:!0},"Caption")),e.contentEditable=!1;var n=_.getParent(t,u);n?_.split(n,t,e):_.replace(e,t),c.selection.select(e)}}else h&&(_.remove(h),c.focus(),c.nodeChanged())})}var p,h,b,v,y,x,w,S={},_=c.dom,N=c.settings,I=!1!==N.image_dimensions;h=c.selection.getNode(),(b=_.getParent(h,"figure.image"))&&(h=_.select("img",b)[0]),h&&("IMG"!=h.nodeName||h.getAttribute("data-mce-object")||h.getAttribute("data-mce-placeholder"))&&(h=null),h&&(v=_.getAttrib(h,"width"),y=_.getAttrib(h,"height"),S={src:_.getAttrib(h,"src"),alt:_.getAttrib(h,"alt"),title:_.getAttrib(h,"title"),class:_.getAttrib(h,"class"),width:v,height:y,caption:!!b}),t&&(x={type:"listbox",label:"Image list",values:o.buildListItems(t,function(e){e.value=c.convertURL(e.value||e.url,"src")},[{text:"None",value:""}]),value:S.src&&c.convertURL(S.src,"src"),onselect:function(e){var t=p.find("#alt");(!t.value()||e.lastControl&&t.value()==e.lastControl.text())&&t.value(e.control.text()),p.find("#src").value(e.control.value()).fire("change")},onPostRender:function(){x=this}}),c.settings.image_class_list&&(w={name:"class",type:"listbox",label:"Class",values:o.buildListItems(c.settings.image_class_list,function(e){e.value&&(e.textStyle=function(){return c.formatter.getCssText({inline:"img",classes:[e.value]})})})});var P=[];if(!1!==c.settings.image_description&&c.settings.images_upload_url){var A=".jpg,.jpeg,.png,.gif",C={title:"Upload",type:"form",layout:"flex",autofocus:!0,direction:"column",align:"stretch",padding:"20 20 20 20",items:[{type:"container",layout:"flex",direction:"column",align:"center",spacing:10,items:[{text:"Browse for an image",type:"browsebutton",accept:A,onchange:i},{text:"OR",type:"label"}]},{text:"Drop an image here",type:"dropzone",accept:A,height:100,onchange:i}]};if(P.push(C),c.settings.image_advtab&&(h&&(h.style.marginLeft&&h.style.marginRight&&h.style.marginLeft===h.style.marginRight&&(S.hspace=o.removePixelSuffix(h.style.marginLeft)),h.style.marginTop&&h.style.marginBottom&&h.style.marginTop===h.style.marginBottom&&(S.vspace=o.removePixelSuffix(h.style.marginTop)),h.style.borderWidth&&(S.border=o.removePixelSuffix(h.style.borderWidth)),S.style=c.dom.serializeStyle(c.dom.parseStyle(c.dom.getAttrib(h,"style")))),P.push({title:"Advanced",type:"form",pack:"start",items:[{label:"Style",name:"style",type:"textbox",onchange:function(){if(c.settings.image_advtab){var e=p.toJSON(),t=_.parseStyle(e.style);p.find("#vspace").value(""),p.find("#hspace").value(""),((t=o.mergeMargins(t))["margin-top"]&&t["margin-bottom"]||t["margin-right"]&&t["margin-left"])&&(t["margin-top"]===t["margin-bottom"]?p.find("#vspace").value(o.removePixelSuffix(t["margin-top"])):p.find("#vspace").value(""),t["margin-right"]===t["margin-left"]?p.find("#hspace").value(o.removePixelSuffix(t["margin-right"])):p.find("#hspace").value("")),t["border-width"]&&p.find("#border").value(o.removePixelSuffix(t["border-width"])),p.find("#style").value(_.serializeStyle(_.parseStyle(_.serializeStyle(t))))}}},{type:"form",layout:"grid",packV:"start",columns:2,padding:0,alignH:["left","right"],defaults:{type:"textbox",maxWidth:50,onchange:g},items:[{label:"Vertical space",name:"vspace"},{label:"Horizontal space",name:"hspace"},{label:"Border",name:"border"}]}]})),c.settings.images_upload_url){console.log("testttttt");var T=[{name:"src",type:"filepicker",filetype:"image",label:"Source",onchange:function(e){var t,i,a,r=e.meta||{};x&&x.value(c.convertURL(this.value(),"src")),n.each(r,function(e,t){p.find("#"+t).value(e)}),r.width||r.height||(t=c.convertURL(this.value(),"src"),i=c.settings.image_prepend_url,a=new s("^(?:[a-z]+:)?//","i"),i&&!a.test(t)&&t.substring(0,i.length)!==i&&(t=i+t),this.value(t),o.getImageSize(c.documentBaseURI.toAbsolute(this.value()),function(e){e.width&&e.height&&I&&(v=e.width,y=e.height,p.find("#width").value(v),p.find("#height").value(y))}))},onbeforecall:function(e){e.meta=p.toJSON()}},x];if(!1!==c.settings.image_description&&T.push({name:"alt",type:"textbox",label:"Image description"}),c.settings.image_title&&T.push({name:"title",type:"textbox",label:"Image Title"}),I&&T.push({type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:5,size:3,onchange:d,ariaLabel:"Width"},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:5,size:3,onchange:d,ariaLabel:"Height"},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}),T.push(w),c.settings.image_caption&&e.ceFalse&&T.push({name:"caption",type:"checkbox",label:"Caption"}),c.settings.image_advtab||c.settings.images_upload_url){console.log(T);var L={title:"General",type:"form",items:T};P.push(L)}}p=c.windowManager.open({title:"Insert/edit image",data:S,bodyType:"tabpanel",body:P,onSubmit:f})}else p=c.windowManager.open({title:"Insert/edit image",data:S,body:T,onSubmit:f})}return{open:function(){u(d)}}}}),a("0",["1","2","3"],function(e,t,n){return e.add("image",function(e){e.on("preInit",function(){function n(e){var t=e.attr("class");return t&&/\bimage\b/.test(t)}function i(e){return function(i){for(var a,r=i.length;r--;)a=i[r],n(a)&&(a.attr("contenteditable",e?"false":null),t.each(a.getAll("figcaption"),function(t){t.attr("contenteditable",e?"true":null)}))}}e.parser.addNodeFilter("figure",i(!0)),e.serializer.addNodeFilter("figure",i(!1))}),e.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:n(e).open,stateSelector:"img:not([data-mce-object],[data-mce-placeholder]),figure.image"}),e.addMenuItem("image",{icon:"image",text:"Image",onclick:n(e).open,context:"insert",prependToContext:!0}),e.addCommand("mceImage",n(e).open)}),function(){}}),i("0")()}();